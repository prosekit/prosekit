{"version":3,"file":"prosekit-extensions-strike.js","names":[],"sources":["../src/strike/index.ts"],"sourcesContent":["import {\n  canUseRegexLookbehind,\n  defineCommands,\n  defineKeymap,\n  defineMarkSpec,\n  toggleMark,\n  union,\n  type Extension,\n  type PlainExtension,\n  type Union,\n} from '@prosekit/core'\nimport type { Attrs } from '@prosekit/pm/model'\n\nimport { defineMarkInputRule } from '../input-rule'\n\n/**\n * @internal\n */\nexport type StrikeSpecExtension = Extension<{\n  Marks: {\n    strike: Attrs\n  }\n}>\n\n/**\n * @internal\n */\nexport function defineStrikeSpec(): StrikeSpecExtension {\n  return defineMarkSpec({\n    name: 'strike',\n    parseDOM: [\n      { tag: 's' },\n      { tag: 'strike' },\n      { tag: 'del' },\n      { style: 'text-decoration=line-through' },\n      { style: 'text-decoration-line=line-through' },\n    ],\n    toDOM() {\n      return ['s', 0]\n    },\n  })\n}\n\n/**\n * @internal\n */\nexport type StrikeCommandsExtension = Extension<{\n  Commands: {\n    toggleStrike: []\n  }\n}>\n\n/**\n * @internal\n */\nexport function defineStrikeCommands(): StrikeCommandsExtension {\n  return defineCommands({\n    toggleStrike: () => toggleMark({ type: 'strike' }),\n  })\n}\n\n/**\n * @internal\n */\nexport function defineStrikeKeymap(): PlainExtension {\n  return defineKeymap({\n    'Mod-shift-s': toggleMark({ type: 'strike' }),\n    'Mod-shift-x': toggleMark({ type: 'strike' }),\n  })\n}\n\n/**\n * @internal\n */\nexport function defineStrikeInputRule(): PlainExtension {\n  return defineMarkInputRule({\n    regex: canUseRegexLookbehind()\n      ? /(?<=\\s|^)~~([^\\s~]|[^\\s~][^~]*[^\\s~])~~$/\n      : /~~([^\\s~]|[^\\s~][^~]*[^\\s~])~~$/,\n    type: 'strike',\n  })\n}\n\n/**\n * @internal\n */\nexport type StrikeExtension = Union<\n  [StrikeSpecExtension, StrikeCommandsExtension]\n>\n\n/**\n * @public\n */\nexport function defineStrike(): StrikeExtension {\n  return union(\n    defineStrikeSpec(),\n    defineStrikeCommands(),\n    defineStrikeKeymap(),\n    defineStrikeInputRule(),\n  )\n}\n"],"mappings":";;;;;;;AA2BA,SAAgB,mBAAwC;AACtD,QAAO,eAAe;EACpB,MAAM;EACN,UAAU;GACR,EAAE,KAAK,KAAK;GACZ,EAAE,KAAK,UAAU;GACjB,EAAE,KAAK,OAAO;GACd,EAAE,OAAO,gCAAgC;GACzC,EAAE,OAAO,qCAAqC;GAC/C;EACD,QAAQ;AACN,UAAO,CAAC,KAAK,EAAE;;EAElB,CAAC;;;;;AAeJ,SAAgB,uBAAgD;AAC9D,QAAO,eAAe,EACpB,oBAAoB,WAAW,EAAE,MAAM,UAAU,CAAC,EACnD,CAAC;;;;;AAMJ,SAAgB,qBAAqC;AACnD,QAAO,aAAa;EAClB,eAAe,WAAW,EAAE,MAAM,UAAU,CAAC;EAC7C,eAAe,WAAW,EAAE,MAAM,UAAU,CAAC;EAC9C,CAAC;;;;;AAMJ,SAAgB,wBAAwC;AACtD,QAAO,oBAAoB;EACzB,OAAO,uBAAuB,GAC1B,6CACA;EACJ,MAAM;EACP,CAAC;;;;;AAaJ,SAAgB,eAAgC;AAC9C,QAAO,MACL,kBAAkB,EAClB,sBAAsB,EACtB,oBAAoB,EACpB,uBAAuB,CACxB"}