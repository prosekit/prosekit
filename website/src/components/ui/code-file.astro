---
import fs from 'node:fs/promises'
import CodeGroup from './code-group.astro'

interface Props {
  path: string
}

const { path } = Astro.props

let code: string

try {
  code = await fs.readFile(path, 'utf-8')
} catch (error) {
  throw new Error(`Failed to read file ${path}`, { cause: error })
}

let fileName = path.split('/').pop() || ''
let lang = fileName.split('.').pop()
---

<CodeGroup codes={[{ lang, title: fileName, code }]} />
